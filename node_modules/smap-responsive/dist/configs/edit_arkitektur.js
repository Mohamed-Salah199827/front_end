
var ws = {
		"localhost": {
			proxy: "//localhost/cgi-bin/proxy.py?url="
		},
		"xyz.malmo.se": {
			proxy: "http://xyz.malmo.se/myproxy/proxy.py?url="
		},
		"kartor.malmo.se": {
			proxy: "http://kartor.malmo.se/cgi-bin/proxy.py?url="
		},
		"91.123.201.52": {
			proxy: "http://91.123.201.52/cgi-bin/proxy.py?url="
		},
		"mobile.smap.se": {
			proxy: "http://mobile.smap.se/smap-mobile/ws/proxy.py?url="
		}
};
var proxy = ws.hasOwnProperty(document.domain) ? ws[document.domain].proxy : null;


var config = {
	
	params: {
		center: [13.0212, 55.59387],
		zoom: 12
	},

	ws: ws,
	
	ol: [
			// {
			// 	init: "L.GeoJSON.WFS",
			// 	url: "http://localhost/geoserver/wfs",
			// 	options: {
			// 		params: {
			// 			typeName: "skane:POI_ARKITEKTUR"
			// 		},
			// 		displayName: "Arkitektur",
			// 		layerId: "guidelayer",
			// 		xhrType: "POST",
			// 		useProxy: false,
			// 		attribution: "Malmö stad",
			// 		inputCrs: "EPSG:4326",
			// 		uniqueKey: "fid",
			// 		selectable: true,
			// 		isEditable: true,
			// 		geomType: "POINT",
			// 		reverseAxis: false,
			// 		reverseAxisBbox: true,
			// 		popup:
			// 			'<h4>${fid}: ${title} </h4>'+
			// 			'<div class="gp-mediaicons">${function(p) {'+
			// 					'var out = "";'+
			// 					'var style="margin-right:.3em;";'+
			// 					'if (p.video) {'+
			// 						'	out += \'<span style="\'+style+\'" class="fa fa-film fa-lg"></span>\';'+
			// 						'}'+
			// 					'if (p.audio) {'+
			// 					'	out += \'<span style="\'+style+\'" class="fa fa-volume-up fa-lg"></span>\';'+
			// 					'}'+
			// 				'if (p.pics && p.pics.split(",").length > 1) {'+
			// 				'	out += \'<span style="\'+style+\'" class="fa fa-picture-o fa-lg"></span>\';'+
			// 				'}'+
			// 			'return out;'+
			// 			'}'+
			// 			'}</div>'+
			// 			'${function(p) {'+
			// 					'var out = "";'+
			// 					'var pics = p.pics || "",'+
			// 						'pic;'+
			// 					'pics = pics ? pics.split(",") : [];'+
			// 					'if (pics.length > 1 && pics[0].length) {'+
			// 						'pic = pics[0];'+
			// 					'}'+
			// 					'else if (pics.length === 1) {'+
			// 						'pic = pics;'+
			// 					'}'+
			// 					'else {return "";}'+
			// 					'pic = $.trim(pic);'+
			// 					'return "<img style=\'width:100%;min-width: 200px;max-height:300px;margin-top: 1em;\' src=\'"+pic+"\'></img>";'+
			// 				'}}'
			// 	}
			// }
			// ,
			{
				init: "L.NonTiledLayer.WMS",
				url: "http://localhost/geoserver/wms",
				options: {
					displayName: "Offentliga toaletter",
					layerId: "offentligatoaletter",
					layers: "malmows:HL_GK_TOA_PT_3006_TOALETTER",
					selectable: true,
					selectOptions: {
						info_format: "application/json",
						srs: "EPSG:3008",
						reverseAxis: false,
						reverseAxisBbox: true
					},
					popup: '<div>${ttt}</div>',
					format: 'image/png',
					zIndex: 150,
					attribution: "© Malmö stad",
					transparent: true
				}
			},
			{
				init: "L.TileLayer.WMS",
				url: "http://localhost/geoserver/wms",
				options: {
					displayName: "Cykelvägar",
					layerId: "cykelvagar",
					layers: "malmows:GK_CYKELVAG_L",
					selectable: true,
					selectOptions: {
						info_format: "application/json",
						srs: "EPSG:3008",
						reverseAxis: false,
						reverseAxisBbox: true
					},
					popup: "*",
					format: 'image/png',
					zIndex: 250,
					attribution: "@ Malmö stad",
					transparent: true
				}
			},
			{
				init: "L.NonTiledLayer.WMS",
				url: "http://localhost/smap-server/geoserver/wms?",
				options: {
					displayName: "Hållplatser",
					layerId: "hallplats",
					layers: "common:poi_hallplatser1330_malmo",
					selectable: true,
					selectOptions: {
						info_format: "application/json",
						srs: "EPSG:3008",
						reverseAxis: false,
						reverseAxisBbox: true
					},
					popup: '<div>${caption}</div>\
							<br /><a href="http://mobil.skanetrafiken.se/Templates/Pages/JourneyPlanner/Search.aspx?r=627">Mer information (mobil)</a>\
							<br /><a href="www.skanetrafiken.se">Mer information</a>',
					format: 'image/png',
					zIndex: 150,
					attribution: "© MalmÃ¶ stad",
					transparent: true
				}
			}
		],
		
	bl: [
			{
				init: "L.esri.DynamicMapLayer",
				url: "http://kartor.malmo.se/arcgis/rest/services/malmokarta_3857/MapServer",
				options: {
					//reuseTiles: true,  ANVÄND EJ
					transparent: true,
					format: "png",
					singleTile: true,
					layerId: "stadskartan_dynmaplayer",
					displayName: "Malmö stadskarta Dyn",
					legend: null,
					opacity: 1,
					minZoom: 10,
					maxZoom: 18,
					attribution: '© Malmö Stadsbyggnadskontor',
					zIndex: 1
				}
			},
			{
				init: "L.TileLayer.WMS",
				url: "http://kartor.malmo.se/geoserver/malmows/wms?",
				options: {
					layerId: "malmo_ortofoto",
					displayName: "Fotokarta 2013",
					layers: 'malmows:malmo_orto_2013',
					legend: null,
					minZoom: 10,
					maxZoom: 21,
					format: 'image/png',
					transparent: true,
					opacity: 0.9,
					attribution: "© Malmö Stadsbyggnadskontor",
					zIndex: 2
				}
			}

	],
	
	plugins: [
				// {
				// 	init: "L.Control.MalmoHeader",
				// 	options: {}
				// },
				{
					init: "L.Control.Scale",
					options: {
						imperial: false
					}
				},
				{
					init: "L.Control.Search",
					options: {
						gui: true,
						whitespace: "%20",
						wsOrgProj: "EPSG:3008",
						useProxy: true,
						wsAcUrl: "http://kartor.malmo.se/WS/search-1.0/autocomplete.ashx", // autocomplete
						wsLocateUrl: "http://kartor.malmo.se/WS/search-1.0/sokexakt.ashx" // locate
					}
				},
				{
					init: "L.Control.LayerSwitcher",
					options: {
						toggleSubLayersOnClick: false,
						unfoldOnClick: true,
						unfoldAll: false
					}
				},
				// {
				// 	init: "L.Control.Editor",
				// 	options: {
				// 		useProxy: false
				// 	}
				// },
				{
					init: "L.Control.SelectWMS",
					options: {
						buffer: 5
					}
				},
//					{
//					init: "L.Control.SelectWMS",
//					options: {
//						buffer: 5
//					}
//					},
				{
					init: "L.Control.SelectVector",
					options: {
						buffer: 5
					}
				},
				{
					init: "L.Control.Zoombar",
					options: {}
				},
				{
					init: "L.Control.Geolocate",
					options: {}
				},
				{
					init: "L.Control.ShareLink",
					options: {
						addToMenu: false
					}
				},
				{
					init: "L.Control.GuideIntroScreen",
					options: {
						autoActivate: false
					}
				}
//						{
//							init: "L.Control.Menu",
//							options: {}
//						},
				// {
				// 	init: "L.Control.GuidePopup",
				// 	options: {
				// 		autoActivate: false,
				// 		layerId: "guidelayer",
				// 		dialogTitle: "${title}",
				// 		useProxy: true,
				// 		attrId: "fid",
						
				// 		// This object specifies how to fill the big popup (the modal window).
				// 		// The modalContent parameters can be overridden by individual parameters for each feature.
				// 		modalContent: {
				// 			iconType: null,
				// 			dialogTitle: "${title}",
				// 			fullScreenIntroPic: "${pics}", // Used only when clicking on a media tag, opening in fullscreen
				// 			tabIntro: '${function(p) {'+
				// 				'var out = "";'+
				// 				'var pics = p.pics || "",'+
				// 					'pic;'+
				// 				'pics = pics ? pics.split(",") : [];'+
				// 				'if (pics.length > 1 && pics[0].length) {'+
				// 					'pic = pics[0];'+
				// 				'}'+
				// 				'else if (pics.length === 1) {'+
				// 					'pic = pics;'+
				// 				'}'+
				// 				'else {return "";}'+
				// 				'pic = $.trim(pic);'+
				// 				'return "<img style=\'max-width:70%;max-height:300px;margin-bottom: 1em;\' src=\'"+pic+"\'></img>";'+
				// 			'}}'+
				// 			"<div>${description}</div>",
				// 			tabMedia: [{
				// 				condition: function(p) {
				// 					return p.pics && p.pics.split(",").length >= 1;
				// 				},
				// 				label: 'Bilder från "${title}"',
				// 				mediaType: "image",
				// 				sources: '${function(p){var pics = p.pics.split(","); '+
				// 						'var baseUrl = "";'+
				// 						'var out = [];'+
				// 						'for (var i=0,len=pics.length; i<len; i++) {'+
				// 							'out.push(baseUrl + $.trim(pics[i]));'+
				// 						'}'+
				// 						'return out.join(",");'+
				// 					'}}'
				// 			},
				// 			{
				// 				condition: function(p) {
				// 					return p.video && p.video.length > 0;
				// 				},
				// 				label: 'Kort video om "${title}"',
				// 				mediaType: "video",
				// 				sources: '${video}'
				// 			}

				// 			]
				// 			// ,
				// 			// tabAccess: '<div>'+

				// 			// 	'<p>'+
				// 			// 		'${function(p){var pics = p.pics && p.pics.length ? p.pics.split(",") : []; '+
				// 			// 			'if (pics.length) {'+
				// 			// 				'return "<img height=\'25%\' width=\'25%\' class=\'img-thumbnail\' src=\'//xyz.malmo.se/rest/resources/vara_fotspar/"+$.trim(pics[0])+"\'></img>";'+
				// 			// 			'} else {return "";}'+
				// 			// 		'}}'+
				// 			// 	'"</p>'+
				// 			// '</div>'
				// 		},

				// 		modalContentOverrides: {
							
				// 		}
				// 	}
				// }
	]
};
