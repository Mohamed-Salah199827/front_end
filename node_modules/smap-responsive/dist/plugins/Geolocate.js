!function(t){function o(i){if(n[i])return n[i].exports;var a=n[i]={exports:{},id:i,loaded:!1};return t[i].call(a.exports,a,a.exports,o),a.loaded=!0,a.exports}var n={};return o.m=t,o.c=n,o.p="",o(0)}([function(t,o){"use strict";L.Control.Geolocate=L.Control.extend({options:{position:"bottomright",hoverTooltip:!0,locateOptions:{maxZoom:17,enableHighAccuracy:!0}},_lang:{sv:{errorGeolocate:"Kunde inte hitta din position",notSupported:"Din webbläsare stödjer inte geolokalisering",hoverTooltip:"Hitta din position"},en:{errorGeolocate:"The browser could not detect your position",notSupported:"Your browser does not support geolocation",hoverTooltip:"Find your current location"}},_setLang:function(t){t=t||smap.config.langCode||navigator.language.split("-")[0]||"en",this._lang&&(this.lang=this._lang?this._lang[t]:null)},initialize:function(t){L.setOptions(this,t),this._setLang(t.langCode)},onAdd:function(t){return this.map=t,this._container=L.DomUtil.create("div","leaflet-control-Geolocate"),L.DomEvent.disableClickPropagation(this._container),this.$container=$(this._container),this._drawButton(),this._container},onRemove:function(t){},_drawButton:function(){var t=$('<button id="smap-glocate-btn" class="btn btn-default"><span class="fa fa-location-arrow"></span></button>');this.$container.append(t),this.btn=t,t.on("touchstart click",$.proxy(function(){return this.active?this.deactivate():this.activate(),!1},this)),this.options.hoverTooltip&&(t.parent().data("bs.tooltip")||t.parent().tooltip({title:this.lang.hoverTooltip,trigger:"hover",placement:"left"}))},activate:function(){return this.active?!1:navigator.geolocation?(this.active=!0,this.btn.addClass("btn-primary"),smap.cmd.loading(!0),this.__onLocationFound=this.__onLocationFound||$.proxy(this._onLocationFound,this),this.__onLocationError=this.__onLocationError||$.proxy(this._onLocationError,this),this.__onDragStart=this.__onDragStart||$.proxy(this._onDragStart,this),this.map.on("locationfound",this.__onLocationFound),this.map.on("locationerror",this.__onLocationError),this.map.on("dragstart",this.__onDragStart),this.map.on("zoomstart",this.__onDragStart),void this._startLocate(this.options.locateOptions)):(smap.cmd.notify(this.lang.notSupported,"error"),!1)},deactivate:function(){return this.active?(this.active=!1,smap.cmd.loading(!1),this.btn.removeClass("btn-primary"),this.map.off("locationfound",this.__onLocationFound),this.map.off("locationerror",this.__onLocationError),this.map.off("dragstart",this.__onDragStart),this.map.off("zoomstart",this.__onDragStart),this._stopLocate(),void(this.marker&&(this.map.removeLayer(this.marker),this.marker=null))):!1},_startLocate:function(t){t=t||{};var o={watch:!0,setView:!0,enableHighAccuracy:!1};t=$.extend(o,t),this.map.locate(t)},_stopLocate:function(){this.map.stopLocate()},_onLocationFound:function(t){smap.cmd.loading(!1),this.marker=this.marker||L.userMarker(t.latlng,{pulsing:!0}).addTo(this.map),this.marker.setLatLng(t.latlng),this.marker.setAccuracy(t.accuracy)},_onLocationError:function(t){smap.cmd.loading(!1);var o=smap.cmd.notify(this.lang.errorGeolocate+": "+t.message,"error",{parent:$("body")});o.on("touchstart",function(){$("body").find(".alert").remove()}),this.deactivate()},_onDragStart:function(){this._stopLocate(),this._startLocate({setView:!1})}}),L.control.geolocate=function(t){return new L.Control.Geolocate(t)}}]);