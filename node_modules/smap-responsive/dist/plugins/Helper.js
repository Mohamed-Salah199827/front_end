!function(t){function e(s){if(i[s])return i[s].exports;var o=i[s]={exports:{},id:s,loaded:!1};return t[s].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e){"use strict";L.Control.Helper=L.Control.extend({options:{autoActivate:!1,position:"topright",steps:[{title:"Welcome to Malmö Stadsatlas!",description:'<p>Would you like to take a little tour?</p><div class="smap-helper-button-group smap-helper-tour-or-not" style="text-align: left; font-size:1.5em;"><div class="smap-helper-button"><i class="fa fa-close"></i><span> No</span></div><div class="smap-helper-button" style="margin-left: 10px;"><span>Yes </span><i class="fa fa-check"></i></div></div>',noNav:!0,func:function(){var t=this._$stepContainer.find(".smap-helper-tour-or-not"),e=t.find(".smap-helper-button:eq(0)"),i=t.find(".smap-helper-button:eq(1)"),s=this;e.on("click",function(){return s.deactivate(),!1}),i.on("click",function(){return s.goToNextStep(),!1}),t.addClass("smap-helper-fadein")}},{title:"Toggle button",description:"To hide the switcher you can press this button.",breakPoint:991,bbox:{selector:".lswitch-btnhide",mobileSelector:!1},css:{side:"right"}},{title:"Layer switcher",description:"The layer switcher is not visible from start on mobile devices. Try making the window smaller and notice that the switcher hides. You can then show it by clicking the expand button in the lower left section of the map.",breakPoint:991,bbox:{selector:".lswitch-panel .panel",mobileSelector:"#lswitch-btn"},css:{side:"right",mobileSide:"bottom"},func:function(){}},{title:"Search functionality",description:"The search functionality is vast. You can search for Malmö addresses or a place like Turning Torso, or Zlatans home.",bbox:{selector:"#smap-search-div"},css:{side:"bottom"}},{title:"Tools",description:"These are the basic tools for map navigation",bbox:{selector:".leaflet-bottom.leaflet-right"},css:{side:"top"}},{title:"Masthead",description:"Left",bbox:{selector:"#malmo-masthead"},css:{side:"bottom"}},{title:"Search again",description:"The search functionality is vast. You can search for Malmö addresses or a place like Turning Torso, or Zlatans home.",bbox:{selector:"#smap-search-div"},css:{side:"bottom"}},{title:"That's it",description:'<p>If you have questions, please contact stadsatlas@malmo.se</p><div id="smap-helper-done" class="smap-helper-button" style="font-size:1.5em;"><span>Done </span><i class="fa fa-check"></i></div>',noNav:!0,func:function(){var t=this;$("#smap-helper-done").on("click",function(){return t.deactivate(),!1})}}]},_lang:{sv:{btnLabel:"Hjälp"},en:{btnLabel:"Help"}},_setLang:function(t){t=t||smap.config.langCode,this._lang&&(this.lang=this._lang?this._lang[t]:null)},initialize:function(t){L.setOptions(this,t),this._setLang(t.langCode)},onAdd:function(t){this.map=t,this._container=L.DomUtil.create("div","leaflet-control-helper"),L.DomEvent.disableClickPropagation(this._container),this.$container=$(this._container),this._createBtn();var e=this;return this._refresh=function(){setTimeout(function(){e.refresh()},500)},this._container},onRemove:function(t){},_createBtn:function(){var t=this;this.$btn=$('<button id="smap-helper-btn" title="'+t.lang.btnLabel+'" class="btn btn-default"><span class="fa fa-question"></span></button>'),this.$btn.on("touchend click",function(){return t.activate(),!1}),this.$container.append(this.$btn)},activate:function(){return this._active&&this._active===!0?this.deactivate():(this._active=!0,this._nbr=0,this._prevNbr=0,this._drawBasic(),this._bindEvents(),this.goToStep(1),$(this._bgCanvas).addClass("smap-helper-fadein"),void $(window).on("resize",this._refresh))},deactivate:function(){if(this._active===!1)return!1;this._active=!1;var t=this;this._$btnClose.remove(),this._$btnClose=null,this._$clickTip.popover("destroy"),this._$clickTip.empty().remove(),this._$clickTip=null,t._$stepContainer.empty().remove(),t._$stepContainer=null,$(this._bgCanvas).removeClass("smap-helper-fadein"),setTimeout(function(){$(t._bgCanvas).remove(),t._bgCanvas=null},300),$(window).off("resize",this._refresh),this._unbindEvents()},_unbindEvents:function(){$("body").off("keydown",this.onKeyDown)},_bindEvents:function(){var t=this;this._$clickTip.find(".smap-helper-button").on("tap click",function(){var e=$(this).index();switch(e){case 0:t.goToPrevStep();break;case 1:t.goToNextStep()}return!1}),this.onKeyDown=function(e){switch(e.which){case 27:t.deactivate();break;case 37:t.goToPrevStep();break;case 38:t.goToPrevStep();break;case 39:t.goToNextStep();break;case 40:t.goToNextStep()}return!1},$("body").on("keydown",this.onKeyDown)},_drawBasic:function(){if(this._$stepContainer)return!1;var t=this;this._$btnClose=$('<div class="smap-helper-btnclose"><i class="fa fa-close"></i></div>'),$("#maindiv").append(this._$btnClose),this._$btnClose.on("tap click",function(){return t.deactivate(),!1}),this._$stepContainer=$('<div class="smap-helper-stepcont"><div class="smap-helper-steptitle"><span>The title</span></div><div class="smap-helper-stepdescription">The description</div></div>'),this._$clickTip=$('<div class="smap-helper-button-group smap-helper-clicktip"><div class="smap-helper-button smap-helper-button-icon-effect"><i class="fa fa-chevron-left"></i><span> Back</span></div><div class="smap-helper-button smap-helper-button-icon-effect"><span>Next </span><i class="fa fa-chevron-right"></i></div></div>'),$("#mapdiv").append(this._$clickTip);var e='<canvas class="smap-helper-bgcanvas" />';$("#mapdiv").append(this._$stepContainer),$("body").append(e),this._bgCanvas=$(".smap-helper-bgcanvas")[0]},_drawCanvasHole:function(t){var e=this._bgCanvas,i=e.getContext("2d");i.clearRect(0,0,e.width,e.height);var s=$(window).width(),o=$(window).height();if(t){var n=[];if(t instanceof Array)n=t;else if(t.selector){var a=15,r=t.selector,l=$(r),c=l.offset(),p=0,h=0,d=0,f=0;n.push(c.left+p-a-d),n.push(c.top+h-a-f),n.push(c.left+l.width()+p+a-d),n.push(c.top+l.height()+h+a-d)}var u=n[0],b=n[1],v=n[2],m=n[3]}e.width=s,e.height=o,i.moveTo(0,0),i.lineTo(s,0),i.lineTo(s,o),i.lineTo(0,o),i.lineTo(0,0),i.closePath(),t&&(i.moveTo(u,b),i.lineTo(u,m),i.lineTo(v,m),i.lineTo(v,b),i.lineTo(u,b),i.closePath()),i.fillStyle="rgba(0,0,0,0.5)",i.shadowColor="rgba(0,0,0,1)",i.shadowBlur=20,i.fill()},refresh:function(){this.goToStep(this._nbr)},goToStep:function(t){var e=this;if(0>=t)return!1;if(this._prevNbr=this._nbr,this._nbr=t,this._$clickTip.removeClass("smap-helper-fadein"),t>this.options.steps.length)return this.deactivate();var i=this.options.steps[t-1],s=this._$stepContainer.find(".smap-helper-steptitle"),o=this._$stepContainer.find(".smap-helper-stepdescription");s.find("span").empty().html(i.title),o.empty().html(i.description);var n;if(i.bbox&&i.bbox.selector){if(n=i.bbox.selector,i.breakPoint&&$(window).width()<=i.breakPoint&&(n=i.bbox.mobileSelector),n===!1)return this._prevNbr<this._nbr?this.goToNextStep():this.goToPrevStep();this._$stepContainer.css(i.css.standard?i.css.standard:i.css),i.css.side&&$(document).ready(function(){var t,e,s=i.css.side;i.bbox.breakPoint&&i.css.mobileSide&&$(window).width()<=i.bbox.breakPoint&&(s=i.css.mobileSide),"top"===s?(t="bottom",e=s+"-20px"):"bottom"===s?(t="top",e=s+"+20px"):"left"===s?(t="right",e=s+"-20px"):"right"===s&&(t="left",e=s+"+20px"),$(".smap-helper-stepcont").position({my:t,at:e,of:n,collision:"fit flip"})})}else $(".smap-helper-stepcont").position({my:"center",at:"center",of:"#mapdiv",collision:"fit flip"});i.css&&i.css.standard&&this._$stepContainer.css(i.css.standard),this._drawCanvasHole({selector:n}),this._showHelperTimeout&&clearTimeout(this._showHelperTimeout),i.noNav||($(".smap-helper-clicktip").popover("destroy"),this._$clickTip.show(),this._nbr>=this.options.steps.length?this._$clickTip.find(".smap-helper-button:eq(1)").hide():this._$clickTip.find(".smap-helper-button").show(),this._showHelperTimeout=setTimeout(function(){e._$clickTip.addClass("smap-helper-fadein"),utils.isTouchOnly()||e._helperPopoverShownOnce||(e._helperPopoverShownOnce=!0,$(".smap-helper-clicktip").popover({content:'Tip! Use your keyboards\' arrow keys to navigate through the help section <i class="fa fa-caret-square-o-left"><i class="fa fa-caret-square-o-up"></i><i class="fa fa-caret-square-o-right"><i class="fa fa-caret-square-o-down"></i>',html:!0,placement:"top",trigger:"manual",container:".maindiv"}).popover("show"),$(".smap-helper-clicktip").data("bs.popover").$tip.addClass("smap-helper-popover"))},950)),i.func&&i.func.call(this)},goToPrevStep:function(){this.goToStep(this._nbr-1)},goToNextStep:function(){this.goToStep(this._nbr+1)}})}]);